{
 "align_labels_right": 0,
 "creation": "2020-07-28 13:10:55.855463",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Inn Reservation",
 "docstatus": 0,
 "doctype": "Print Format",
 "font": "Default",
 "html": "{% set company = frappe.get_doc(\"Global Defaults\").default_company %}\n{% set address = frappe.get_doc(\"Inn Hotels Setting\").address %}\n{% set phone = frappe.get_doc(\"Inn Hotels Setting\").phone %}\n{% set fax = frappe.get_doc(\"Inn Hotels Setting\").fax %}\n{% set email = frappe.get_doc(\"Inn Hotels Setting\").email %}\n{% set bank_account = frappe.get_doc(\"Inn Hotels Setting\").bank_account %}\n\n<div>\n    <h3><b>{{company|upper}}</b></h3>\n    <p>{{address}}</p>\n    <p>Phone: {{phone}} Fax: {{fax}}</p>\n    <hr style='border:0.5px solid black; width:100%; margin:5px 0px 10px 0px;'>\n</div>\n\n<div class=\"row\">\n  <div class=\"col-xs-2\">\n    <p><b>Customer: </b></p>\n  </div>\n  <div class=\"col-xs-10\">\n    <p>{{doc.customer_id}}</p>\n  </div>\n</div>\n\n{% set date = get_date() %}\n\n<div class=\"row\">\n  <div class=\"col-xs-2\">\n    <p><b>Date: </b></p>\n  </div>\n  <div class=\"col-xs-10\">\n    <p>{{date}}</p>\n  </div>\n</div>\n\n<table class= \"table\">\n  <tr>\n    <th>No</th>\n    <th>Arrival Date</th>\n    <th>Departure Date</th>\n    <th>Room Type</th>\n    <th>Room Rate</th>\n    <th>Total Room</th>\n    <th>Total Night</th>\n    <th>Total</th>\n  </tr>\n  {% if doc.status != 'Reserved' %}\n    <tr>\n      <td>-</td>\n      <td>-</td>\n      <td>-</td>\n      <td>-</td>\n      <td>-</td>\n      <td>-</td>\n      <td>-</td>\n      <td>-</td>\n    </tr>\n  {% else %}\n    {% set reservations = [] %}\n    {% if doc.group_id != None %}\n      {% set reservations = frappe.get_all(\"Inn Reservation\", filters={\"group_id\": doc.group_id}, fields=[\"expected_arrival\", \"expected_departure\", \"room_type\", \"room_rate\", \"init_actual_room_rate\", \"total_night\"]) %}\n    {% else %}\n      {% set reservations = frappe.get_all(\"Inn Reservation\", filters={\"name\": doc.name}, fields=[\"expected_arrival\", \"expected_departure\", \"room_type\", \"room_rate\", \"init_actual_room_rate\", \"total_night\"]) %}\n    {% endif %}\n\n    {% set total_rooms = {} %}\n\n    {% for r in reservations %}\n      {% set key = r.expected_arrival.strftime('%Y-%m-%d') + r.expected_departure.strftime('%Y-%m-%d') + r.room_type + r.room_rate %}\n      {% if key not in total_rooms %}\n        {% set _ = total_rooms.update({key: 1}) %}\n      {% else %}\n        {% set _ = total_rooms.update({key: total_rooms[key] + 1}) %}\n      {% endif %}\n    {% endfor %}\n    \n    {% set variable = namespace(number = 1) %}\n    {% set key_used = {} %}\n    {% set total = namespace(amount = 0.0) %}\n\n    {% for r in reservations %}\n      {% set key = r.expected_arrival.strftime('%Y-%m-%d') + r.expected_departure.strftime('%Y-%m-%d') + r.room_type + r.room_rate %}\n      {% if key not in key_used %}\n        {% set amount = total_rooms[key]*r.total_night*r.init_actual_room_rate %}\n        {% set total.amount = total.amount + amount %}\n\n        <tr>\n          <td>{{variable.number}}</td>\n          <td>{{r.expected_arrival}}</td>\n          <td>{{r.expected_departure}}</td>\n          <td>{{r.room_type}}</td>\n          <td>{{frappe.format_value(r.init_actual_room_rate, {\"fieldtype\":\"Currency\"})}}</td>\n          <td>{{total_rooms[key]}}</td>\n          <td>{{r.total_night}}</td>\n          <td>{{frappe.format_value(amount, {\"fieldtype\":\"Currency\"})}}</td>\n        </tr>\n        {% set variable.number = variable.number + 1 %}\n        {% set _ = key_used.update({key: \"\"}) %}\n      {% endif %}\n    {% endfor %}\n\n    <tr>\n      <td colspan=\"6\"</td>\n      <td>Total</td>\n      <td>{{frappe.format_value(total.amount, {\"fieldtype\":\"Currency\"})}}</td>\n    </tr>\n\n    {% set deposit = 0.0 %}\n    {% set data = get_total_deposit(doc) %}\n    {% if data[0].amount != None %}\n      {% set deposit = data[0].amount %}    \n    {% endif %}\n    \n    <tr>\n      <td colspan=\"6\"</td>\n      <td>Down Payment</td>\n      <td>{{frappe.format_value(deposit, {\"fieldtype\":\"Currency\"})}}</td>\n    </tr>\n\n    <tr>\n      <td colspan=\"6\"</td>\n      <td>Balance</td>\n      <td>{{frappe.format_value(total.amount-deposit, {\"fieldtype\":\"Currency\"})}}</td>\n    </tr>\n\n    <tr>\n      <td colspan=\"8\"></td>\n    </tr>\n\n  {% endif %}\n</table>\n\n<div class=\"row\">\n  <div class=\"col-xs-12\">\n    <p><b>METHOD OF PAYMENT:</b></p>\n    <p>Payment to be settled by Cash, Bank Transfer, Credit Card or Company Cheque to be made payable to:</p>\n  <table class=\"table table-bordered\">\n    <tr>\n        <th>Bank Name</th>\n        <th>Account Number</th>\n        <th>Account Name</th>\n    </tr>\n    {% set accounts = frappe.get_all(\"Bank Account\", filters={\"account\": [\"like\", \"1121.0%\"]}, fields=[\"bank\", \"account_name\", \"bank_account_no\"]) %}\n    {%- for row in accounts -%}\n    <tr>\n        <td>{{row.bank}}</td>\n        <td>{{row.bank_account_no}}</td>\n        <td>{{row.account_name}}</td>\n    </tr>\n    {%- endfor -%}\n  </table>\n\n   \t\n  </div>\n</div>\n\n<br />\n\n<div class=\"row\">\n  <div class=\"col-xs-12\">\n    <p class=\"text-justify\">Please do not hesitate to contact us at {{phone}} or via fax {{fax}} for any information you may need.\nWe would like to thank you, once again and look forward to the opportunity to organize you event and assure you the\nbest service and attention at all times.</p>\n  </div>\n</div>\n\n<br /><br />\n\n<div class=\"row\">\n  <div class=\"col-xs-6\">\n    <p class=\"text-center\">Our best regards,</p>\n  </div>\n  <div class=\"col-xs-6\">\n    <p class=\"text-center\">Accepted & Agreed by,</p>\n  </div>\n</div>\n\n<br /><br /><br /><br />\n\n<div class=\"row\">\n  <div class=\"col-xs-6\">\n    <p class=\"text-center\"><b>{{ frappe.db.get_value(\"User\", frappe.user, \"full_name\") }}</b></p>\n  </div>\n  <div class=\"col-xs-6\">\n    <p class=\"text-center\"></p>\n  </div>\n</div>\n<div class=\"row\">\n  <div class=\"col-xs-6\">\n    <p class=\"text-center\">Reservation</p>\n  </div>\n  <div class=\"col-xs-6\">\n    <p class=\"text-center\"></p>\n  </div>\n</div>",
 "idx": 0,
 "line_breaks": 0,
 "modified": "2022-04-09 16:15:01.966920",
 "modified_by": "Administrator",
 "module": "Inn Hotels",
 "name": "Proforma Invoice Reservation",
 "owner": "Administrator",
 "print_format_builder": 0,
 "print_format_type": "Server",
 "show_section_headings": 0,
 "standard": "Yes"
}